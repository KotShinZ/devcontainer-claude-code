# CLAUDE.md

## コミュニケーションガイドライン

- **言語**: 原則、日本語を用いる。
- **完遂主義**: 全てのタスクが完璧に終わるまで、繰り返し挑戦を継続
- **環境構築**: 実行環境が不足している場合は適切に準備
- **視覚化**: 実行結果は、必ずグラフや図表を画像として出力。数値データもなるべくグラフや図表にする。
- **全力投球**: 遠慮せずに最高品質を目指す
- **信憑性**: 勝手に結果を推測するなどして、**偽の結果、模擬結果を作らない**ようにする。
- **結果の確認**: 出力したグラフや図表の画像を読み込んで、それが正しい結果であることを必ず確認する。

### コーディング規則

- 日本語コメントの徹底
- テンソルサイズの明記（機械学習プロジェクト）
- クラス指向設計による可読性向上
- 1ファイルにつき1クラス
- 型ヒントの徹底
- ipynb は使用しない
- 詳細デバッグをprintする
- **try-catchは使用しない。**エラーを見逃す可能性があるため。
- フォールバック処理の禁止

### コードの実行

- 実行ファイル数は 最小限にする。
- --config でコンフィグを設定することで、実行時の挙動を変更する。
- --step で短時間でのテスト実行も出来るようにする。

### コンフィグの記述規則
- コンフィグを処理するdataclassの作成
- コンフィグのクラスでは変数にdictは用いない。
- 各パラメータの説明は分かりやすく一行以内で書く。
- デフォルト値であってもコンフィグファイルに記述する

### プロジェクト構成

project_name/
├── config/ # コンフィグ
├──────product/ # 本番用コンフィグ
├──────tests/ # テスト用コンフィグ
├── src/ # ソースコード
├────── run/ # 実行ファイル
├── tests/ # テストコード
├── results/ # 出力結果（画像、データ等）
├── docs/ # ドキュメント
├── requirements.txt
└── README.md

- 多くのフォルダを用いて、ファイルの細分化を行うこと。
- その他必要なフォルダを作成すること。
- markdownファイルは必ずdocxフォルダに入れる。
- testコードは必ずtestsフォルダに入れる。
- 各実行でresultsフォルダ内にフォルダを作成する。フォルダ名は実行した時刻を加える

### バージョン管理(git)
- コミットやプッシュは行わない

### テスト駆動開発（TDD）

- 原則としてテスト駆動開発（TDD）で進める
- 期待される入出力に基づき、まずテストを作成する
- 実装コードは書かず、テストのみを用意
- テストを実行し、失敗を確認する
- テストが正しいことを確認できた段階でコミットする
- その後、テストをパスさせる実装を進める
- 実装中はテストを変更せず、コードを修正し続ける
- すべてのテストが通過するまで繰り返す
- テストのコードは tests フォルダに入れて実行すること。

## 結果出力

- 終了時に、markdown で report.md に概要、パラメータ、結果などを分かりやすく記入。
- "![name](path)"というように、グラフや図表などは markdown に挿入する。
- markdown の数式は latex 形式で記入する。
- japanize-matplotlib を用いて、matplotlib を日本語に対応させる。

## 禁止事項
**絶対に守ること！**
- プロジェクト名の変更
- フォルダ名の変更
- ファイル名の変更
- gitでのプッシュ、コミット
- gitignoreの変更
- ダミーデータの使用(テストのみ可。本番では適切なデータをダウンロード)

## 専門分野別ガイドライン

### データサイエンス・機械学習

- **可視化**: matplotlib/seaborn による分かりやすいグラフ作成
- **再現性**: random_seed の設定と固定
- **環境**: pytorch を使用。必要に応じてその他のライブラリを使用
- **記録**: 学習時のハイパーパラメータや、loss などは tensorboard で記録するようにすること。
- **データセット**: 必要なデータセットをダウンロードしてきて必ずそれを使ってください。ダミーデータは使わないように。
- **学習**: config で**小さい学習ステップ数**で学習を行い、エラーが出ないことと、結果が良いことを確認する。ただし、**モデルサイズ、アーキテクチャは変えない**こと。その後、大規模な設定の config ファイルを作成して、ユーザーが行うべきことを指示する。大規模な学習はユーザーが実行するためプログラムを実行してはいけない。
- **学習ループ**: ニューラルネットワークの学習ループでは tqdm を用いて学習過程や loss の値を表示すること。
- **バッチサイズ**: 適切なバッチサイズを探索して学習を行う。探索では、大きいバッチサイズから試していって、だんだん小さくする。バッチサイズは必ず 2 の n 乗にすること。バッチサイズが 1 でも OOM になる場合は一度相談すること。
- **学習データ**: 学習データは Web からダウンロード出来るものを使用すること。ダウンロード出来ない場合は、代替出来るデータセットをダウンロードすること。時間がかかってもいいので、必要量ダウンロードすること。
- **ダミーデータ**: **ダミーデータは一切作らないこと**。その代わりダウンロードしてきたデータの一部を使用すること。
- **tensorboard**: loss や精度を tensorboard を用いて記録すること。

### Web 開発

- **視認性**: リッチで視認性の高いユーザーインターフェースにすること。
- **ポート**: 8000, 8080 のうち空いているポートを使用すること。
- **結果**: localhost:8000 で使用できるようにすること。(8000, 8080 のうちのどれか)
- **エラー対策**: Web サイトを動かした時に、エラーが発生するケースが多いため、適度に console にログを出力するようにして。

## 作業の合言葉

- **「コミット」**: `/commit.md` コマンドを実行
- **「テスト」**: `/test_all` コマンドを実行
